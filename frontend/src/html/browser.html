<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="bathtown">
    <meta name="COPYRIGHT" content="Fotagrafia">
    <meta name="description" content="browser page">
    <!-- jQuery -->
    <script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
    <!-- jquery-confirm -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="../css/general.css">
    <link rel="stylesheet" type="text/css" href="../css/browser.css">
    <link rel="icon" href="../../img/favicon.ico" type="image/x-icon">
    <base target="_self">
    <title>browser</title>
</head>

<body>

    <header>
        <ul>
            <li id="bar">
                <a><span class="fa fa-bars"></span></a>
                <ul id="barlist">
                    <li><a href="../html/home.html" class="home"><span><span class="fa fa-home"></span> Home</span></a>
                    </li>
                    <li><a href="../html/browser.html" class="browser imlooking"><span class="fa fa-cloud"></span>
                            Browser</a>
                    </li>
                    <li><a href="../html/search.html" class="search"><span class="fa fa-search"></span> Search</a></li>
                </ul>
            </li>

            <li id="logo"><a href="../html/bicycle.html"><span class="fa fa-bicycle"></span></a></li>

            <li class="account">
                <a target="_self" href="../html/login.html" class="myAccount"><span class="fa fa-child"></span>
                    Log in</a>
                <a class="my" target="_self" href="../html/login.html"><span class="fa fa-child"></span></a>
            </li>

            <li class="account">
                <a class="myAccount">My Account <span class="fa fa-angle-down"></span></a>
                <a class="my"><span class="fa fa-user"></span></a>
                <ul>
                    <li><a href="../html/upload.html"><span class="fa fa-cloud-upload"></span> Upload</a></li>
                    <li><a href="../html/myGallery.html"><span class="fa fa-photo"></span> My Gallery</a></li>
                    <li><a href="../html/myHearts.html"><span class="fa fa-heart"></span> My Hearts</a></li>
                    <li> <a id="logout"><span class="fa fa-sign-out"></span> Log out</a> </li>
                </ul>
            </li>
        </ul>
    </header>

    <main>

        <article id="browser">
            <header class="hinter"> try "üëÜ‚Üí" | Browser | try "‚ÜêüëÜ"</header>

            <aside class="browserAside">

                <form class="searchBox">
                    <input type="text" placeholder="Search by Title..." />
                    <button type="button"><span class="fa fa-search"></span></button>
                </form>

                <h1>Hot Country</h1>
                <ul class="hotList hotCountry">
                    <li><a href="../html/china.html">China</a></li>
                    <li><a href="../html/japan.html">Japan</a></li>
                    <li><a href="../html/italy.html">Italy</a></li>
                </ul>

                <h1>Hot City</h1>
                <ul class="hotList hotCity">
                    <li><a href="../html/Chengdu.html">Chengdu</a></li>
                    <li><a href="../html/Shanghai.html">Shanghai</a></li>
                    <li><a href="../html/NewYork.html">New York</a></li>
                    <!-- <li><a href="../html/London.html" >London</a></li> -->
                </ul>

                <h1>Hot Content</h1>
                <ul class="hotList hotContent">
                    <li><a href="../html/scenery.html">Scenery</a></li>
                    <li><a href="../html/city.html">City</a></li>
                    <li><a href="../html/people.html">People</a></li>
                    <!-- <li><a href="../html/animal.html" >Animal</a></li> -->
                    <!-- <li><a href="../html/building.html" >Building</a></li> -->
                </ul>

            </aside>

            <section class="browserResult">
                <form class="filter" id="threeFilter">
                    <div>
                        <select class="byContent" id="content">
                            <option value="" style="display: none;">Filter by Content</option>
                            <option>Scenery</option>
                            <option>People</option>
                            <option>Animal</option>
                            <option>Building</option>
                        </select>

                        <select class="byCountry" id="country" onchange="countrysCity(this)">
                            <option value="" style="display: none;">Filter by Country</option>
                        </select>

                        <select class="byCity" id="city">
                            <option value="" style="display: none;">Filter by City</option>
                        </select>
                    </div>

                    <button type="button" value="Filter" id="linkageFilter">Filter</button>
                </form>

                <div class="mainPic">
                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                    <div class="picContain">
                        <img src="" onclick="window.open('../html/details.html', '_self')" />
                    </div>

                </div>

                <section class="pageNum">
                    <p>
                        &#60; <span>1</span> 2 3 4 5 6 ... 9 &#62;
                    </p>
                </section>

            </section>
        </article>
    </main>

    <footer>
        <section>
            <copyright id="copyright">Copyright ¬© 2020 Fotagrafia Inc. All rights reserved.</copyright>
            <div>
                <a href="../html/privacy.html">Privacy Policy</a>
                <span>|</span>
                <a href="../html/usage.html">Terms of Use</a>
                <span>|</span>
                <a href="../html/legal.html">Legal</a>
                <span>|</span>
                <a href="../html/siteMap.html">Site Map</a>
            </div>
        </section>
    </footer>

    <script src="../js/feature.js" type="text/javascript"></script>
    <script>
        $(function () {
            $.ajax({
                method: "GET",
                url: "http://localhost:8080/backend/PHP/api/country.php",
            }).done((data) => {
                for (let index = 0; index < data.countries.length; index++) {
                    let newOption = $(`<option value="${data.countries[index]}">${data.countries[index]}</option>`);
                    $('#country').append(newOption)
                }
            }).fail((err) => {
                if (err.status === 0) { myAlert('error', 'Connection refused!'); return; }
                myAlert('error', JSON.parse(err.responseText).message);
            });
        });

        function countrysCity(country) {
            $('#city').empty();

            // console.log(country.options[country.selectedIndex].text);
            $.ajax({
                method: "GET",
                url: "http://localhost:8080/backend/PHP/api/city.php",
                data: { country: $('#country  option:selected').val() }
            }).done((data) => {
                for (let index = 0; index < data.cities.length; index++) {
                    let newOption = $(`<option value="${data.cities[index]}">${data.cities[index]}</option>`);
                    $('#city').append(newOption)
                }
            }).fail((err) => {
                if (err.status === 0) { myAlert('error', 'Connection refused!'); return; }
                myAlert('error', JSON.parse(err.responseText).message);
            });
        }

        $('#linkageFilter').click(function () {

            // scenery Canada Calgary
            let content = $('#content option:selected').val();
            let city = $('#city  option:selected').val();
            let country = $('#country option:selected').val();

            if (!content && !city && !country) {
                // myAlert('warning', 'Please select!');
                // return;
                content = 'scenery';
                country = 'Canada';
                city = 'Calgary';
            }

            $.ajax({
                method: "POST",
                url: "http://localhost:8080/backend/PHP/api/browser.php",
                data: { content: content, city: city, country: country }
            }).done((data) => {
                for (let index = 0; index < data.imgs.length; index++) {
                    $('img').eq(index).attr('src', `http://localhost:8080/backend/travel-images/large/${data.imgs[index]}`);
                }
            }).fail((err) => {
                console.log(err);

                if (err.status === 0) { myAlert('error', 'Connection refused!'); return; }
                myAlert('error', JSON.parse(err.responseText).message);
            });
        })
    </script>

</body>

</html>
